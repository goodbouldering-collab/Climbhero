# ClimbHero - クライミング動画共有プラットフォーム（完全版）

## プロジェクト概要
- **名称**: ClimbHero
- **目的**: クライマー向けの本格的な動画共有プラットフォーム。YouTube等のクライミング動画URLを投稿・共有し、コミュニティで楽しむ。
- **主要機能**: 完全な会員システム、ランキング、ブログCMS、横スクロールUI、コメント、検索機能搭載

## 🌐 アクセスURL
- **開発環境**: https://3000-iekbypsjbezyid8wqeonx-2e77fc33.sandbox.novita.ai

## ✨ 完成済み機能（すべて動作確認済み）

### 🔐 会員認証システム
- ✅ 新規登録（メール、ユーザー名、パスワード）
- ✅ ログイン/ログアウト
- ✅ セッション管理（Cookie）
- ✅ ユーザーメニュー
- ✅ マイページ

### 🎬 動画機能
- ✅ 動画一覧表示（グリッド + 横スクロール）
- ✅ カテゴリーフィルタリング（4カテゴリー）
- ✅ 動画検索機能
- ✅ 動画URL投稿
- ✅ いいね機能（認証必須）
- ✅ お気に入り機能（認証必須）
- ✅ 動画詳細モーダル
- ✅ 閲覧数カウント

### 🎨 UI/UX
- ✅ レスポンシブデザイン（PC/タブレット/モバイル）
- ✅ 横スクロールUI（フリップカード効果）
- ✅ カードフリップアニメーション（ホバー時に裏面表示）
- ✅ ハンバーガーメニュー（モバイル対応）
- ✅ モーダルウィンドウ
- ✅ 通知システム（成功/エラー/警告）

### 💬 コメント機能
- ✅ 動画ごとのコメント表示
- ✅ コメント投稿（認証必須）
- ✅ ユーザー名表示
- ✅ 投稿日時表示

### 🏆 ランキングシステム
- ✅ 週間ランキング
- ✅ 月間ランキング
- ✅ 総合ランキング
- ✅ スコア計算（いいね:10pt、お気に入り:5pt、コメント:3pt）
- ✅ トップ3メダル表示
- ✅ ランキング専用ページ

### 📝 ブログCMS
- ✅ ブログ一覧表示
- ✅ ブログ詳細ページ
- ✅ ブログ投稿機能（認証必須）
- ✅ ブログ編集機能
- ✅ ブログ削除機能
- ✅ 画像URL対応
- ✅ 公開日設定

### 👤 マイページ
- ✅ プロフィール表示
- ✅ お気に入り動画一覧
- ✅ 会員種別表示（無料/プレミアム）

### 🔍 検索機能
- ✅ キーワード検索
- ✅ タイトル/説明文検索
- ✅ Enterキー対応
- ✅ 検索結果表示

## 🎯 新機能ハイライト

### 横スクロールUI（フリップカード）
```css
/* ホバーで裏返るカード効果 */
.video-card:hover .video-card-inner {
  transform: rotateY(180deg);
}
```
- トップページに人気動画を横スクロール表示
- マウスホイールやタッチでスクロール可能
- スムーズなスクロールバー

### ランキング計算ロジック
```
スコア = いいね数 × 10 + お気に入り数 × 5 + コメント数 × 3
```
- 動画のエンゲージメント総合評価
- 週間/月間/総合の3種類
- 自動更新

## 📊 データベース構造

### テーブル構成
1. **users**: ユーザー情報（認証、会員タイプ、セッション）
2. **videos**: 動画情報（URL、サムネイル、カテゴリー、統計）
3. **likes**: いいね関連（ユーザー×動画）
4. **favorites**: お気に入り（ユーザー×動画）
5. **comments**: コメント（ユーザー×動画、本文）
6. **video_rankings**: ランキングデータ（週間/月間/総合スコア）
7. **blog_posts**: ブログ記事（タイトル、本文、画像、公開日）

### ストレージ
- **Cloudflare D1**: SQLite分散データベース
- **セッション管理**: HTTPOnly Cookie

## 🛠️ 技術スタック
- **バックエンド**: Hono (v4.10.3) + TypeScript
- **データベース**: Cloudflare D1 (SQLite)
- **フロントエンド**: TailwindCSS + Vanilla JavaScript (SPA)
- **認証**: Cookie-based Session
- **デプロイ**: Cloudflare Pages
- **開発**: Wrangler CLI + PM2

## 🚀 使い方

### 1. 新規登録
1. 右上「新規登録」ボタンをクリック
2. ユーザー名、メールアドレス、パスワードを入力
3. 「登録」ボタンで完了

### 2. 動画を投稿
1. ログイン後、「動画投稿」セクションへ
2. YouTube等の動画URLを入力
3. タイトル、説明、カテゴリーを選択
4. 「投稿する」ボタンで完了

### 3. いいね・お気に入り
- 動画カードのハートアイコンでいいね
- 星アイコンでお気に入り登録
- ※ログインが必要です

### 4. コメント投稿
1. 動画カードをホバーして裏面を表示
2. 「詳細・コメント」ボタンをクリック
3. コメント入力欄にテキストを入力
4. 「コメントする」ボタンで投稿

### 5. ランキング閲覧
1. ヘッダーメニュー「ランキング」をクリック
2. 週間/月間/総合を切り替え
3. トップ3はメダル表示

### 6. ブログ機能
- **閲覧**: 「ブログ」メニューから一覧表示
- **投稿**: ログイン後、右上「新規投稿」ボタン
- **編集/削除**: 各記事の編集・削除アイコン

### 7. マイページ
1. ログイン後、右上のユーザーアイコンをクリック
2. 「マイページ」を選択
3. お気に入り動画を確認

### 8. 検索
1. トップページの検索バーにキーワード入力
2. Enterキーまたは虫眼鏡アイコンをクリック
3. 該当する動画を表示

## 📱 レスポンシブ対応

### PC (1024px以上)
- 4カラムグリッド
- ホバーアニメーション
- フルメニュー表示

### タブレット (768px - 1023px)
- 2-3カラムグリッド
- タッチ対応

### モバイル (767px以下)
- 1カラムグリッド
- ハンバーガーメニュー
- タッチジェスチャー対応

## 🎨 デザイン特徴

### カラースキーム
- **メインカラー**: パープル (#667eea → #764ba2)
- **アクセント**: レッド（いいね）、イエロー（お気に入り）
- **背景**: グレー50

### アニメーション
- **カードフリップ**: 3D回転効果 (0.6s)
- **ホバー**: translateY(-5px) + shadow
- **モーダル**: fadeIn + slideIn
- **通知**: スライドイン/アウト

## 🔧 開発コマンド

```bash
# ビルド
npm run build

# ローカル開発サーバー起動
npm run clean-port          # ポート3000クリーンアップ
pm2 start ecosystem.config.cjs

# データベース操作
npm run db:migrate:local    # マイグレーション実行
npm run db:seed             # テストデータ投入
npm run db:reset            # データベースリセット

# PM2操作
pm2 list                    # プロセス一覧
pm2 logs webapp --nostream  # ログ確認
pm2 restart webapp          # 再起動
pm2 stop webapp             # 停止
pm2 delete webapp           # 削除

# テスト
curl http://localhost:3000/api/videos
curl http://localhost:3000/api/rankings/weekly
```

## 📡 API エンドポイント

### 認証
- `POST /api/auth/register` - 新規登録
- `POST /api/auth/login` - ログイン
- `POST /api/auth/logout` - ログアウト
- `GET /api/auth/me` - 現在のユーザー情報取得

### 動画
- `GET /api/videos` - 動画一覧取得（検索、フィルター対応）
- `GET /api/videos/:id` - 動画詳細取得
- `POST /api/videos` - 動画投稿（認証必須）
- `POST /api/videos/:id/like` - いいね切替（認証必須）
- `POST /api/videos/:id/favorite` - お気に入り切替（認証必須）
- `GET /api/videos/:id/liked` - いいね状態確認
- `GET /api/videos/:id/favorited` - お気に入り状態確認

### コメント
- `GET /api/videos/:id/comments` - コメント一覧取得
- `POST /api/videos/:id/comments` - コメント投稿（認証必須）

### ランキング
- `GET /api/rankings/:type` - ランキング取得（weekly/monthly/total）

### ブログ
- `GET /api/blog` - ブログ一覧取得
- `GET /api/blog/:id` - ブログ詳細取得
- `POST /api/blog` - ブログ投稿（認証必須）
- `PUT /api/blog/:id` - ブログ更新（認証必須）
- `DELETE /api/blog/:id` - ブログ削除（認証必須）

### ユーザー
- `GET /api/users/:id/videos` - ユーザーの投稿動画取得
- `GET /api/users/:id/favorites` - ユーザーのお気に入り動画取得

## 🔒 セキュリティ

- HTTPOnly Cookie（XSS対策）
- パスワードハッシュ化（Base64エンコード）
- セッショントークン（ランダム生成）
- CORS設定（API保護）

**注意**: 本番環境ではbcryptなど強力なハッシュアルゴリズムを使用してください。

## 🎯 次のステップ提案

1. **決済統合**: Stripe導入でプレミアム会員機能実装
2. **YouTube API**: 自動メタデータ取得
3. **AI判定**: Cloudflare AI Workersでコンテンツ分類
4. **通知機能**: いいね・コメント時の通知
5. **本番デプロイ**: Cloudflare Pagesへデプロイ
6. **カスタムドメイン**: 独自ドメイン設定
7. **パスワードリセット**: メール送信機能
8. **プロフィール編集**: アバター、自己紹介
9. **動画埋め込み**: YouTube iframe埋め込み
10. **ソーシャルシェア**: Twitter/Facebook共有

## 📂 プロジェクト構成

```
webapp/
├── src/
│   └── index.tsx           # メインHonoアプリ（API + ルーティング）
├── public/
│   └── static/
│       ├── app.js          # フロントエンドJS（SPA）
│       └── styles.css      # カスタムCSS
├── migrations/
│   ├── 0001_initial_schema.sql
│   └── 0002_add_comments_and_rankings.sql
├── seed.sql                # テストデータ
├── fix_rankings.sql        # ランキング初期化
├── ecosystem.config.cjs    # PM2設定
├── wrangler.jsonc          # Cloudflare設定
├── package.json            # 依存関係・スクリプト
└── README.md               # このファイル
```

## 🐛 トラブルシューティング

### ログインできない
- ブラウザのCookieが有効か確認
- 正しいメール/パスワードか確認
- データベースをリセット: `npm run db:reset`

### 動画が表示されない
- PM2ログ確認: `pm2 logs webapp --nostream`
- データベース確認: `npm run db:seed`

### ポート3000が使用中
```bash
npm run clean-port
pm2 restart webapp
```

## 📝 ライセンス
MIT License

## 👤 作成者
由井辰美 (Tatsumi Yui)
- グッぼる ボルダリングCafe & Shop
- Notエステ（セルフ美容サロン）
- rasiku（COO）

---

**すべての機能が実装済みです！ブラウザでアクセスして動作を確認してください！** 🎉
